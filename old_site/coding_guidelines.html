---
layout: obsolete
title: "Coding Guidelines"
permalink: /old_site/Coding_Guidelines/
redirect_from:
  - /Coding_Guidelines/
  - /CodingGuildelines/
  - /Guidelines/
---

<h1>Coding Guidelines</h1>

<p><br />
This document contains the coding guidelines for the Mono Project.   It contains four major sections:
</p>
<ul><li> <a href="#Style_Guidelines">Style Guidelines</a>, on how to organize your source code.
</li><li> <a href="#Git_Workflow_Changes">Git Workflow Changes</a> discusses how our workflow has changed now that Mono is hosted on GitHub.
</li><li> <a href="#Source_Code_Control">Source Code Control</a> details our source code control use.
</li><li> <a href="#Best_Practices">Best Practices</a>, used in the project.
</li></ul>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Style_Guidelines"><span class="tocnumber">1</span> <span class="toctext">Style Guidelines</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Indentation"><span class="tocnumber">1.1</span> <span class="toctext">Indentation</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Performance_and_Readability"><span class="tocnumber">1.2</span> <span class="toctext">Performance and Readability</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Where_to_put_spaces"><span class="tocnumber">1.3</span> <span class="toctext">Where to put spaces</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Where_to_put_braces"><span class="tocnumber">1.4</span> <span class="toctext">Where to put braces</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Multiline_Parameters"><span class="tocnumber">1.5</span> <span class="toctext">Multiline Parameters</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Use_whitespace_for_clarity"><span class="tocnumber">1.6</span> <span class="toctext">Use whitespace for clarity</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#File_headers"><span class="tocnumber">1.7</span> <span class="toctext">File headers</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Multiline_comments"><span class="tocnumber">1.8</span> <span class="toctext">Multiline comments</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Casing"><span class="tocnumber">1.9</span> <span class="toctext">Casing</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#this"><span class="tocnumber">1.10</span> <span class="toctext">this</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Line_length_and_alignment"><span class="tocnumber">1.11</span> <span class="toctext">Line length and alignment</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Initializing_Instances"><span class="tocnumber">1.12</span> <span class="toctext">Initializing Instances</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Baroque_Coding"><span class="tocnumber">1.13</span> <span class="toctext">Baroque Coding</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Warnings"><span class="tocnumber">1.14</span> <span class="toctext">Warnings</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Conditional_compilation"><span class="tocnumber">1.15</span> <span class="toctext">Conditional compilation</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Missing_Implementation_Bits"><span class="tocnumber">1.16</span> <span class="toctext">Missing Implementation Bits</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#NotImplementedException"><span class="tocnumber">1.17</span> <span class="toctext">NotImplementedException</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Use_of_var"><span class="tocnumber">1.18</span> <span class="toctext">Use of var</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Use_Simple_Identifiers"><span class="tocnumber">1.19</span> <span class="toctext">Use Simple Identifiers</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Examples"><span class="tocnumber">1.20</span> <span class="toctext">Examples</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#Source_Code_Control"><span class="tocnumber">2</span> <span class="toctext">Source Code Control</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#Summary_Description"><span class="tocnumber">2.1</span> <span class="toctext">Summary Description</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Work_Branches"><span class="tocnumber">2.2</span> <span class="toctext">Work Branches</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#RCS_and_CVS_tags"><span class="tocnumber">2.3</span> <span class="toctext">RCS and CVS tags</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Backporting_Changes"><span class="tocnumber">2.4</span> <span class="toctext">Backporting Changes</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#ChangeLogs"><span class="tocnumber">2.5</span> <span class="toctext">ChangeLogs</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#File_formats"><span class="tocnumber">2.6</span> <span class="toctext">File formats</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#Best_Practices"><span class="tocnumber">3</span> <span class="toctext">Best Practices</span></a>
<ul>
<li class="toclevel-2 tocsection-30"><a href="#Documentation"><span class="tocnumber">3.1</span> <span class="toctext">Documentation</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Tests"><span class="tocnumber">3.2</span> <span class="toctext">Tests</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Check_all_arguments"><span class="tocnumber">3.3</span> <span class="toctext">Check all arguments</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Be_careful_about_freeing_memory"><span class="tocnumber">3.4</span> <span class="toctext">Be careful about freeing memory</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Watch_for_integer_.5Bunder.7Cover.5Dflows"><span class="tocnumber">3.5</span> <span class="toctext">Watch for integer [under|over]flows</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Locking_and_Threading"><span class="tocnumber">3.6</span> <span class="toctext">Locking and Threading</span></a>
<ul>
<li class="toclevel-3 tocsection-36"><a href="#Deadlocks"><span class="tocnumber">3.6.1</span> <span class="toctext">Deadlocks</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="#Don.27t_lock_on_Types_and_Strings"><span class="tocnumber">3.6.2</span> <span class="toctext">Don't lock on Types and Strings</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="#Git_Workflow_Changes"><span class="tocnumber">4</span> <span class="toctext">Git Workflow Changes</span></a>
<ul>
<li class="toclevel-2 tocsection-39"><a href="#One_Line_Summaries"><span class="tocnumber">4.1</span> <span class="toctext">One Line Summaries</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#No_more_manual_ChangeLog_editing"><span class="tocnumber">4.2</span> <span class="toctext">No more manual ChangeLog editing</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Personal_Work_Branches"><span class="tocnumber">4.3</span> <span class="toctext">Personal Work Branches</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Style_Guidelines"> Style Guidelines </span></h1>
<p>In order to keep the code consistent, please use the following conventions.  From here on `good' and `bad' are used to attribute things that would make the coding style match, or not match.  It is not a judgment call on your coding abilities, but more of a style and look call.  Please try to follow these guidelines to ensure prettiness.
</p><p>You may also wish to read the <a href="http://msdn.microsoft.com/en-us/library/ms229042.aspx" class="external text" rel="nofollow">.Net Framework Design Guidelines</a> as well, however the Mono guidelines below take precedent for Mono code if there is a conflict.
</p>
<h2> <span class="mw-headline" id="Indentation"> Indentation </span></h2>
<p>Use 8 space tabs for writing your code (hopefully we can keep this consistent).  If you are modifying someone else's code, try to keep the coding style similar.
</p><p>Since we are using 8-space tabs, you might want to consider the Linus Torvalds trick to reduce code nesting.  Many times in a loop, you will find yourself doing a test, and if the test is true, you will nest. Many times this can be changed.  Example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span>i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>something <span style="color: #008000;">&#40;</span>i<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
		do_more <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>This takes precious space, instead write it like this:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span>i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">!</span>something <span style="color: #008000;">&#40;</span>i<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
		<span style="color: #0600FF; font-weight: bold;">continue</span><span style="color: #008000;">;</span>
	do_more <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><br />
Switch statements have the case at the same indentation as the switch:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">switch</span> <span style="color: #008000;">&#40;</span>x<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
<span style="color: #0600FF; font-weight: bold;">case</span> <span style="color: #666666;">'a'</span><span style="color: #008000;">:</span>
	<span style="color: #008000;">...</span>
<span style="color: #0600FF; font-weight: bold;">case</span> <span style="color: #666666;">'b'</span><span style="color: #008000;">:</span>
	<span style="color: #008000;">...</span>
<span style="color: #008000;">&#125;</span></pre>
<h2> <span class="mw-headline" id="Performance_and_Readability"> Performance and Readability </span></h2>
<p>It is more important to be correct than to be fast.
</p><p>It is more important to be maintainable than to be fast.
</p><p>Fast code that is difficult to maintain is likely going to be looked down upon.
</p>
<h2> <span class="mw-headline" id="Where_to_put_spaces"> Where to put spaces </span></h2>
<p>Use a space before an opening parenthesis when calling functions, or indexing, like this:
</p>
<pre class="csharp" style="font-family:monospace;">method <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
b <span style="color: #008000;">&#91;</span><span style="color: #FF0000;">10</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span></pre>
<p>Do not put a space after the opening parenthesis and the closing one, ie:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;">method <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>	
array <span style="color: #008000;">&#91;</span><span style="color: #FF0000;">10</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;">method <span style="color: #008000;">&#40;</span> a <span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>	
array<span style="color: #008000;">&#91;</span> <span style="color: #FF0000;">10</span> <span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span></pre>
<p>Do not put a space between the generic types, ie:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">var</span> list <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> List<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">var</span> list <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> List <span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<h2> <span class="mw-headline" id="Where_to_put_braces"> Where to put braces </span></h2>
<p>Inside a code block, put the opening brace on the same line as the statement:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
	code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span> 
<span style="color: #008000;">&#123;</span>
	code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Avoid using unnecessary open/close braces, vertical space is usually limited:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span>
	code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
	code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Unless there are either multiple hierarchical conditions being used or that the condition cannot fit into a single line.
</p><p>good:ï»¿
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>b<span style="color: #008000;">&#41;</span>
		code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span>
	<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>b<span style="color: #008000;">&#41;</span>
		code <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>When defining a method, use the C style for brace placement, that means, use a new line for the brace, like this:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> Method <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> Method <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Properties and indexers are an exception, keep the brace on the same line as the property declaration.
</p><p>Rationale: this makes it visually simple to distinguish them.
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">int</span> Property <span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">value</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">int</span> Property 
<span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">value</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Notice how the accessor "get" also keeps its brace on the same line.
</p><p>For very small properties, you can compress things:
</p><p>ok:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">int</span> Property <span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span> <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">value</span><span style="color: #008000;">;</span> <span style="color: #008000;">&#125;</span>
	<span style="color: #0600FF; font-weight: bold;">set</span> <span style="color: #008000;">&#123;</span> x <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">value</span><span style="color: #008000;">;</span> <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><br />
Empty methods: They should have the body of code using two lines, in consistency with the rest:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> EmptyMethod <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> EmptyMethod <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span><span style="color: #008000;">&#125;</span></pre>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> EmptyMethod <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
<span style="color: #008000;">&#125;</span></pre>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> EmptyMethod <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> 
<span style="color: #008000;">&#123;</span><span style="color: #008000;">&#125;</span></pre>
<p>If statements with else clauses are formatted like this:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>dingus<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">...</span>
<span style="color: #008000;">&#125;</span> <span style="color: #0600FF; font-weight: bold;">else</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">...</span> 
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>dingus<span style="color: #008000;">&#41;</span> 
<span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">...</span>
<span style="color: #008000;">&#125;</span> 
<span style="color: #0600FF; font-weight: bold;">else</span> 
<span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">...</span> 
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>dingus<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">...</span>
<span style="color: #008000;">&#125;</span> 
<span style="color: #0600FF; font-weight: bold;">else</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">...</span> 
<span style="color: #008000;">&#125;</span></pre>
<p>Classes and namespaces go like if statements, differently than methods:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">namespace</span> N <span style="color: #008000;">&#123;</span>
	<span style="color: #6666cc; font-weight: bold;">class</span> X <span style="color: #008000;">&#123;</span>
		<span style="color: #008000;">...</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">namespace</span> N
<span style="color: #008000;">&#123;</span>
	<span style="color: #6666cc; font-weight: bold;">class</span> X
	<span style="color: #008000;">&#123;</span>
		<span style="color: #008000;">...</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>So, to summarize:
</p>
<table border="1" cellpadding="5" cellspacing="0" align="center">

<tr>
<th style="background:#d9e5bf;"> Statement
</th>
<th style="background:#d9e5bf;"> Brace position
</th></tr>
<tr>
<td> Namespace
</td>
<th style="background-color: #8CDD81"> same line
</th></tr>
<tr>
<td> Type
</td>
<th style="background-color: #8CDD81"> same line
</th></tr>
<tr>
<td> Method (including ctor)
</td>
<th style="background-color: #FF2233"> new line
</th></tr>
<tr>
<td> Properties
</td>
<th style="background-color: #8CDD81"> same line
</th></tr>
<tr>
<td> Control blocks (if, for...)
</td>
<th style="background-color: #8CDD81"> same line
</th></tr>
<tr>
<td> Anonymous types and methods
</td>
<th style="background-color: #8CDD81"> same line
</th></tr>
</table>
<h2> <span class="mw-headline" id="Multiline_Parameters"> Multiline Parameters </span></h2>
<p>When you need to write down parameters in multiple lines, indent the parameters to be below the previous line parameters, like this:
</p><p>Good:
</p>
<pre class="csharp" style="font-family:monospace;">WriteLine <span style="color: #008000;">&#40;</span>format, foo,
           bar, baz<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>If you do not want to have parameters in the same line as the method invocation because you ar running out of space, you can indent the parameters in the next line, like this:
</p><p>Good:
</p>
<pre class="csharp" style="font-family:monospace;">WriteLine <span style="color: #008000;">&#40;</span>
       format, moved, too, <span style="color: #6666cc; font-weight: bold;">long</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>Comma separators go at the end, like a good book, never at the beginning:
</p><p>Good:
</p>
<pre class="csharp" style="font-family:monospace;">WriteLine <span style="color: #008000;">&#40;</span>foo,
           bar,
           baz<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>Atrocious:
</p>
<pre class="csharp" style="font-family:monospace;">WriteLine <span style="color: #008000;">&#40;</span>foo
           , bar
           , baz<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<h2> <span class="mw-headline" id="Use_whitespace_for_clarity"> Use whitespace for clarity </span></h2>
<p>Use white space in expressions liberally, except in the presence of parenthesis:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a <span style="color: #008000;">+</span> <span style="color: #FF0000;">5</span> <span style="color: #008000;">&gt;</span> method <span style="color: #008000;">&#40;</span>blah <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">+</span><span style="color: #FF0000;">5</span><span style="color: #008000;">&gt;</span>method<span style="color: #008000;">&#40;</span>blah<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">+</span><span style="color: #FF0000;">4</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span></pre>
<h2> <span class="mw-headline" id="File_headers"> File headers </span></h2>
<p>For any new files, please use a descriptive introduction, like this:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">//</span>
<span style="color: #008080; font-style: italic;">// System.Comment.cs: Handles comments in System files.</span>
<span style="color: #008080; font-style: italic;">//</span>
<span style="color: #008080; font-style: italic;">// Author:</span>
<span style="color: #008080; font-style: italic;">//   Juan Perez (juan@address.com)</span>
<span style="color: #008080; font-style: italic;">//</span>
<span style="color: #008080; font-style: italic;">// Copyright (C) 2002 Address, Inc (http://www.address.com)</span>
<span style="color: #008080; font-style: italic;">//</span></pre>
<p>If you are modyfing someone else's code, and your contribution is significant, please add yourself to the Authors list.
</p>
<h2> <span class="mw-headline" id="Multiline_comments"> Multiline comments </span></h2>
<p>For long, multiline comments use either:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">/*
 * Blah
 * Blah again
 * and another Blah
 */</span></pre>
<p>Or:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">//</span>
<span style="color: #008080; font-style: italic;">// Blah</span>
<span style="color: #008080; font-style: italic;">// Blah again</span>
<span style="color: #008080; font-style: italic;">// and another Blah</span>
<span style="color: #008080; font-style: italic;">//</span></pre>
<h2> <span class="mw-headline" id="Casing"> Casing </span></h2>
<p>Argument names should use the camel casing for identifiers, like this:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> Method <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> myArgument<span style="color: #008000;">&#41;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> Method <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> lpstrArgument<span style="color: #008000;">&#41;</span></pre>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> Method <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> my_string<span style="color: #008000;">&#41;</span></pre>
<p>(There is an exception to this rule: <a href="{{site.baseurl}}/old_site/GtkSharp" title="GtkSharp">Gtk#</a> codebase, in which you should use under_score.)
</p><p>Instance fields should use underline as a separator:
</p><p>good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> X <span style="color: #008000;">&#123;</span>
     <span style="color: #6666cc; font-weight: bold;">string</span> my_string<span style="color: #008000;">;</span>
     <span style="color: #6666cc; font-weight: bold;">int</span>    very_important_value<span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>passable:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> X <span style="color: #008000;">&#123;</span>
      <span style="color: #6666cc; font-weight: bold;">string</span> myString<span style="color: #008000;">;</span>
      <span style="color: #6666cc; font-weight: bold;">int</span>    veryImportantValue<span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> X <span style="color: #008000;">&#123;</span>
      <span style="color: #6666cc; font-weight: bold;">int</span>      _intval<span style="color: #008000;">;</span>
      <span style="color: #6666cc; font-weight: bold;">string</span>   m_string<span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>The use of "m_" and "_" as prefixes for instance members is highly discouraged.  
</p><p>An exception to this rule is serializable classes. In this case, if we desire to have our serialized data be compatible with Microsoft's, we must use the same field name.
</p>
<h2> <span class="mw-headline" id="this"> this </span></h2>
<p>The use of "this." as a prefix in code is discouraged, it is mostly redundant.   In general, since internal variables are lowercase and anything that becomes public starts with an uppercase letter, there is no ambiguity between what the "Foo" and "foo" are.   The first is a public property or field, the second is internal property or field.
</p><p>Good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Foo <span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">int</span> bar<span style="color: #008000;">;</span>
&#160;
    <span style="color: #6666cc; font-weight: bold;">void</span> Update <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> newValue<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       bar <span style="color: #008000;">=</span> newValue<span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
&#160;
    <span style="color: #6666cc; font-weight: bold;">void</span> Clear <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       Update <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Bad:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Foo <span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">int</span> bar<span style="color: #008000;">;</span>
&#160;
    <span style="color: #6666cc; font-weight: bold;">void</span> Update <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> newValue<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">bar</span> <span style="color: #008000;">=</span> newValue<span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
&#160;
    <span style="color: #6666cc; font-weight: bold;">void</span> Clear <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Update</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>An exception is made for "this" when the parameter name is the same as an instance variable, this happens sometimes in constructors or if naming is difficult:
</p><p>Good:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Message <span style="color: #008000;">&#123;</span>
     <span style="color: #6666cc; font-weight: bold;">char</span> text<span style="color: #008000;">;</span>
&#160;
     <span style="color: #0600FF; font-weight: bold;">public</span> Message <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> text<span style="color: #008000;">&#41;</span>
     <span style="color: #008000;">&#123;</span>
         <span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">text</span> <span style="color: #008000;">=</span> text<span style="color: #008000;">;</span>
     <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<h2> <span class="mw-headline" id="Line_length_and_alignment"> Line length and alignment </span></h2>
<p>Line length: The line length for C# source code is 180 columns (Used to be 80).
</p><p>If your function declaration arguments go beyond this point, please align your arguments to match the opening brace.  For best results use the same number
of tabs used on the first line followed by enough spaces to align the 
arguments.  That ensures that the arguments will remain aligned when viewed with a different tabsize.  In the following example, the line that declares argc is indented with 2 tabs and 15 spaces:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">namespace</span> N <span style="color: #008000;">&#123;</span>
	<span style="color: #6666cc; font-weight: bold;">class</span> X <span style="color: #008000;">&#123;</span>
		<span style="color: #6666cc; font-weight: bold;">void</span> Function <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> arg, <span style="color: #6666cc; font-weight: bold;">string</span> argb,
		               <span style="color: #6666cc; font-weight: bold;">int</span> argc<span style="color: #008000;">&#41;</span>
		<span style="color: #008000;">&#123;</span>
		<span style="color: #008000;">&#125;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>When invoking functions, the rule is different, the arguments are not aligned with the previous argument, instead they begin at the tabbed position, like this:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> M <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
	MethodCall <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Very long string that will force&quot;</span>,
		<span style="color: #666666;">&quot;Next argument on the 8-tab pos&quot;</span>,
		<span style="color: #666666;">&quot;Just like this one&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<h2> <span class="mw-headline" id="Initializing_Instances"> Initializing Instances </span></h2>
<p>Use the new C# syntax to initialize newly created objects.
</p><p>Bad:
</p>
<pre class="csharp" style="font-family:monospace;">     <span style="color: #0600FF; font-weight: bold;">var</span> x <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Foo <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
     x<span style="color: #008000;">.</span><span style="color: #0000FF;">Label</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;This&quot;</span><span style="color: #008000;">;</span>
     x<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">=</span> Color<span style="color: #008000;">.</span><span style="color: #0000FF;">Red</span><span style="color: #008000;">;</span></pre>
<p>Good:
</p>
<pre class="csharp" style="font-family:monospace;">     <span style="color: #0600FF; font-weight: bold;">var</span> x <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Foo <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
         Label <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;This&quot;</span>,
         Color <span style="color: #008000;">=</span> Color<span style="color: #008000;">.</span><span style="color: #0000FF;">Red</span>
     <span style="color: #008000;">&#125;</span><span style="color: #008000;">;</span></pre>
<p><br />
</p>
<h2> <span class="mw-headline" id="Baroque_Coding"> Baroque Coding </span></h2>
<p>Baroque coding is discouraged.
</p><p>We discourage the use of the "private" keyword to flag internal fields or methods since this is the default visibility mode in C#.    The keyword exists because of Java. Avoid it, it merely is more line noise for people that are reading your code.
</p><p>But the same principle applies everywhere else in Mono.   Avoid complex code or redundant code for the sake of it.  Try to write the minimum amount of text possible.
</p>
<h2> <span class="mw-headline" id="Warnings"> Warnings </span></h2>
<p>Avoid commiting code with warnings to the repository, the use of #pragmas to disable warnings is strongly discouraged, but can be used \on unique cases.  Please justify the use of the warning ignore clause on a comment.
</p><p>Do not commit changes to the Makefiles that removes warnings, if anything warnings should be eliminated one at a time, and if not possi\ble, they must be flagged.
</p>
<h2> <span class="mw-headline" id="Conditional_compilation"> Conditional compilation </span></h2>
<p>Ideally we would not need conditional compilation, and the use of #ifdef is strongly discouraged.  But due to our support for old C# 1.0 compilers we have to use it in a few places.
</p><p>Try to avoid negative tests that have an else clause, for example:
</p>
<pre class="csharp" style="font-family:monospace;">            <span style="color: #008080;">#if&#160;!NET_2_0</span>
                CODE_FOR_1_0
            <span style="color: #008080;">#else</span>
                CODE_FOR_2_0
            <span style="color: #008080;">#endif</span></pre>
<p>Instead use:
</p>
<pre class="csharp" style="font-family:monospace;">            <span style="color: #008080;">#if NET_2_0</span>
                CODE_FOR_2_0
            <span style="color: #008080;">#else</span>
                CODE_FOR_1_0
            <span style="color: #008080;">#endif</span></pre>
<p>When a major feature differs across compilation targets, try to factor out the code into a separate class, a helper class or a separate file, and include that in your profile while surrounding that helper file/class with the ifdefs to reduce the amount of ifdefs in the code.
</p><p>For instance, this is used for some parts of Grasshopper where the code is ifdefed out, when large parts of a file would have been ifdefed out, we moved the code into a MyOtherFile.jvm.cs
</p><p>For 2.0 classes, this is even simpler as code can be trivially factored out into
</p>
<pre>MyHelperClass.cli.cs
MyHelperClass.jvm.cs
</pre>
<p>By using partial classes.
</p>
<h2> <span class="mw-headline" id="Missing_Implementation_Bits"> Missing Implementation Bits </span></h2>
<p>There are a number of attributes that can be used in the class libraries to flag the specific state of an API, class or field.
</p><p>The following attributes exist:
</p><p>MonoDocumentationNote, MonoExtension, MonoInternalNote, MonoLimitation and MonoNotSupported.
</p><p>If you implement a class and you are missing implementation bits, please use the attribute MonoTODO.  This attribute can be used to programatically generate our status web pages:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008000;">&#91;</span>MonoTODO <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;My Function is not available on Mono&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
<span style="color: #6666cc; font-weight: bold;">int</span> MyFunction <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">throw</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NotImplementedException <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Ideally, write a human description of the reason why there is a MonoTODO, this will be useful in the future for our automated tools that can assist in developers porting their code.
</p><p>Do not use MonoTODO attributes for reminding yourself of internal changes that must be done.  Use FIXMEs or other kinds of comments in the source code for that purpose, and if the problem requires to be followed up on, <a href="{{site.baseurl}}/old_site/Bugs" title="Bugs">file a bug</a>.
</p>
<h2> <span class="mw-headline" id="NotImplementedException"> NotImplementedException </span></h2>
<p>In the Mono class libraries, if a library is stubbed out, it is customary to insert the following code snippet:
</p>
<pre class="csharp" style="font-family:monospace;">    <span style="color: #0600FF; font-weight: bold;">throw</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NotImplementedException <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span></pre>
<p>The NotImplemented exception is used by tools like the <a href="{{site.baseurl}}/old_site/Moma" title="Moma" class="mw-redirect">Mono Migration Analyzer</a> (Moma) to report potential problems for people porting their applications.
</p><p>Notice that in certain conditions, throwing a NotImplementedException is a pattern used in base virtual methods to force derived classes to implement the functionality.   This can lead to incorrect reports from the Moma tool, because the tool has no way of knowing that in practice the virtual base method will never be called (it would be better to have an abstract class in this case, but we have to be source and binary compatible).   In these cases, instead of throwing the exception directly, call a helper routine, so that it becomes invisible to Moma:
</p>
<pre class="csharp" style="font-family:monospace;">Exception GetNotImplemented <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
     <span style="color: #0600FF; font-weight: bold;">return</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NotImplementedException <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #6666cc; font-weight: bold;">void</span> SomeMethod <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
     <span style="color: #0600FF; font-weight: bold;">throw</span> GetNotImplemented <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Remember the rule: NotImplementedExceptions should be exposed in the toplevel method that is exposed to developers for Moma to properly work.
</p>
<h2> <span class="mw-headline" id="Use_of_var"> Use of var </span></h2>
<p>Use var on the left-hand side of an assignment when the type name is repeated on the right hand side:
</p><p>bad:
</p>
<pre class="csharp" style="font-family:monospace;">    NSUuid monkeyUUID <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NSUuid <span style="color: #008000;">&#40;</span>uuid<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>good:
</p>
<pre class="csharp" style="font-family:monospace;">    <span style="color: #0600FF; font-weight: bold;">var</span> monkeyUUID <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NSUuid <span style="color: #008000;">&#40;</span>uuid<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    NSUuid something <span style="color: #008000;">=</span> RetrieveUUID <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<h2> <span class="mw-headline" id="Use_Simple_Identifiers"> Use Simple Identifiers </span></h2>
<p>Use simple identifiers when possible. 
</p><p>passable:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">var</span> speechSynthesizer <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> AVSpeechSynthesizer <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">var</span> speechUtterance <span style="color: #008000;">=</span>
  <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> AVSpeechUtterance <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Shall we play a game?&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
speechSynthesizer<span style="color: #008000;">.</span><span style="color: #0000FF;">SpeakUtterance</span> <span style="color: #008000;">&#40;</span>speechUtterance<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>delightful:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">var</span> synthesizer <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> AVSpeechSynthesizer <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">var</span> utterance <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> AVSpeechUtterance <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Shall we play a game?&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
synthesizer<span style="color: #008000;">.</span><span style="color: #0000FF;">SpeakUtterance</span> <span style="color: #008000;">&#40;</span>utterance<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<h2> <span class="mw-headline" id="Examples"> Examples </span></h2>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> X <span style="color: #008000;">:</span> Y <span style="color: #008000;">&#123;</span>
	<span style="color: #6666cc; font-weight: bold;">bool</span> Method <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> argument_1, <span style="color: #6666cc; font-weight: bold;">int</span> argument_2<span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>argument_1 <span style="color: #008000;">==</span> argument_2<span style="color: #008000;">&#41;</span>
			<span style="color: #0600FF; font-weight: bold;">throw</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Exception <span style="color: #008000;">&#40;</span>Locale<span style="color: #008000;">.</span><span style="color: #0000FF;">GetText</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;They are equal!&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>argument_1 <span style="color: #008000;">&lt;</span> argument_2<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>argument_1 <span style="color: #008000;">*</span> <span style="color: #FF0000;">3</span> <span style="color: #008000;">&gt;</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">&#41;</span>
				<span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
			<span style="color: #0600FF; font-weight: bold;">else</span>
				<span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">false</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #008080; font-style: italic;">//</span>
		<span style="color: #008080; font-style: italic;">// This sample helps keep your sanity while using 8-spaces for tabs</span>
		<span style="color: #008080; font-style: italic;">// </span>
		VeryLongIdentifierWhichTakesManyArguments <span style="color: #008000;">&#40;</span>
			Argument1, Argument2, Argument3,
			NestedCallHere <span style="color: #008000;">&#40;</span>
				MoreNested<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
&#160;
	<span style="color: #6666cc; font-weight: bold;">bool</span> MyProperty <span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #0600FF; font-weight: bold;">return</span> x<span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">set</span> <span style="color: #008000;">&#123;</span>
			x <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">value</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
	<span style="color: #008000;">&#125;</span>
&#160;
	<span style="color: #6666cc; font-weight: bold;">void</span> AnotherMethod <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> 
	<span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>a <span style="color: #008000;">+</span> <span style="color: #FF0000;">5</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">!=</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: #008000;">&#40;</span>blah<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>a<span style="color: #008000;">&#41;</span>
				<span style="color: #0600FF; font-weight: bold;">continue</span><span style="color: #008000;">;</span>
			b<span style="color: #008000;">++;</span>
		<span style="color: #008000;">&#125;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<h1> <span class="mw-headline" id="Source_Code_Control"> Source Code Control </span></h1>
<p>Many of us in the Mono team are still getting used to using Git.   Some very useful hints are available in our <a href="{{site.baseurl}}/old_site/GitFAQ" title="GitFAQ">GitFAQ</a> that is geared specifically to the Mono team.
</p>
<h2> <span class="mw-headline" id="Summary_Description"> Summary Description </span></h2>
<p>Include a one-line summary description of your change at the top of your commit message to improve the rendering of the commit history on GitHub.
</p><p>After the one-line summary description, you should continue to add the detailed description of your change to the commit message, detailing what the change does.
</p><p>Example:
</p>
<pre>
[Tag] This is the one line summary of the change

Here you have a more detailed account of the change, the bug it fixes,
the rationale for the change and other details that will help a future
developer understand why this change was made.
</pre>
<p>The <code>[Tag]</code> is optional, but you could try using these for your commits:
</p>
<ul><li> <b>Fix</b> for bug fixes, in the summary include the nature of the fix and the bug #
</li><li> <b>Performance</b> for changes that improve performance
</li><li> <b>Compatibility</b> changes done for the sake of compatibility
</li><li> <b>API</b> for API additions, changes or removals
</li></ul>
<p>We will add more tags as time goes by.
</p>
<ul><li> The commit message is mainly for the other people, so they should be able to understand it now and six months later.
</li><li>Always add a brief description of the commit to the first line of the commit and terminate by two newlines (it will work without the second newline, but that is not nice for the interfaces).
</li><li> First line (the brief description) must only be one sentence and should start with a capital letter unless it starts with a lowercase symbol or identifier. Don't use a trailing period either. Don't exceed 72 characters.
</li><li>You can prefix the first line with one tag, to make it easier to know to which part of the module the commit applies. For example, a commit with "[monodoc] Improve the formatting" in the mono-tools module clearly applies to the monodoc tool.
</li><li> The main description (the body) is normal prose and should use normal punctuation and capital letters where appropriate. Normally, for patches sent to a mailing list it's copied from there. This main description can be empty if the change is self-explanatory (eg: "Add DOAP file").
</li></ul>
<p>When committing code on behalf of others use the --author option, for example:
</p>
<pre class="bash" style="font-family:monospace;"> <span style="color: #c20cb9; font-weight: bold;">git commit</span> <span style="color: #660033;">--author</span> <span style="color: #ff0000;">&quot;Joe Coder &lt;joe@coder.org&gt;&quot;</span>.</pre>
<h2> <span class="mw-headline" id="Work_Branches"> Work Branches </span></h2>
<p>See the description of  <a href="{{site.baseurl}}/old_site/GitFAQ#Workflow_2:_Use_.27master.27_as_integration_branch" title="GitFAQ"> short term branches</a> and
<a href="{{site.baseurl}}/old_site/GitFAQ#Workflow_3:_Long-term_projects" title="GitFAQ"> long term branches</a> in <a href="{{site.baseurl}}/old_site/GitFAQ" title="GitFAQ">GitFAQ</a>.
</p>
<h2> <span class="mw-headline" id="RCS_and_CVS_tags"> RCS and CVS tags </span></h2>
<p>Some users like to use the special RCS/CVS tags in their source code: $id$, $log$ and so on.
</p><p>The use of these is not permitted on the Mono source code repository.   This metadata belongs on a ChangeLog or in the SVN metadata.
</p>
<h2> <span class="mw-headline" id="Backporting_Changes"> Backporting Changes </span></h2>
<p>If you want to backport an interesting change to a branch, you can follow these steps.   
</p><p>Let us say that you want to backport this change: <a href="http://github.com/mono/mono/commit/778694e1b85416a3abfdac4952dd85c8384e1cf8" class="external free" rel="nofollow">http://github.com/mono/mono/commit/778694e1b85416a3abfdac4952dd85c8384e1cf8</a> into the remote branch monotouch-2-0.
</p><p>To do this, first you would create a local branch called "monotouch-2-0" that tracks the remote monotouch-2-0 branch:
</p>
<pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">git checkout</span> <span style="color: #660033;">-b</span> monotouch-<span style="color: #000000;">2</span>-<span style="color: #000000;">0</span> <span style="color: #660033;">-t</span> remotes<span style="color: #000000; font-weight: bold;">/</span>origin<span style="color: #000000; font-weight: bold;">/</span>monotouch-<span style="color: #000000;">2</span>-<span style="color: #000000;">0</span>
Checking out files: <span style="color: #000000;">100</span><span style="color: #000000; font-weight: bold;">%</span> <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">12233</span><span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">12233</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, done.
Branch monotouch-<span style="color: #000000;">2</span>-<span style="color: #000000;">0</span> <span style="color: #000000; font-weight: bold;">set</span> up to track remote branch monotouch-<span style="color: #000000;">2</span>-<span style="color: #000000;">0</span> from origin.
Switched to a new branch <span style="color: #ff0000;">'monotouch-2-0'</span></pre>
<p>The above is only needed if you have never worked on the branch before.   But if you had worked on the branch before, you can just use:
</p>
<pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">git checkout</span> monotouch-<span style="color: #000000;">2</span>-<span style="color: #000000;">0</span>
Switched to branch <span style="color: #ff0000;">'monotouch-2-0'</span></pre>
<p>Then to get the patch, use the hash number in the commit above:
</p>
<pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">git cherry-pick</span> 778694e1b85416a3abfdac4952dd85c8384e1cf8</pre>
<p>You might need to fix any merge issues at this point.
</p><p>Then <b>git add</b> any new files and changed files and then before you commit, use the hash number in your commit to transfer any commit messages, author information and so on, like this:
</p>
<pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">git commit</span> <span style="color: #660033;">-c</span> 778694e</pre>
<p>The magic number there are the first seven digits of the large cherry-pick commit version.   Alternatively, you can use the full commit version:
</p>
<pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">git commit</span> <span style="color: #660033;">-c</span> 778694e1b85416a3abfdac4952dd85c8384e1cf8</pre>
<p>Now that your changes are committed you can push them:
</p>
<pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">git push</span></pre>
<h2> <span class="mw-headline" id="ChangeLogs"> ChangeLogs </span></h2>
<p><b>Update</b>: ChangeLogs are no longer manually updated, instead just use the ChangeLog message on your commit.   At release time, a script merges the commit messages into the proper ChangeLogs that are distributed.  For a few examples on how the script operates on commit messages, see <a href="http://github.com/mono/mono/commits/commit-to-changelog-tests" class="external text" rel="nofollow">this branch on our public repository</a>.
</p><p>You would typically commit your message like this:
</p>
<pre>
One line description

* Makefile (%-profiles): Go through an intermediate set of rules.
Move body to ...
(profiles-do--%): ... this.
(profiles-do--run-test): Customized rule that usefully runs with 'make -j'
and 'make -k'.
(profiles-do--all, profile-do--%--all): Orchestrate the bootstrap process.

* file.cs (MainForm): Updated version.
</pre>
<p>From that point on a list of changes in a file-by-file basis, describing what changes were done.
</p>
<h2> <span class="mw-headline" id="File_formats"> File formats </span></h2>
<p>Historically our repository has used a mix of line-endings, this is a mistake that we are trying hard to fix.  We also have several files where each has itself a mix of line-endings.
</p><p>For existing files, please make sure that you do not convert the file, as that causes us to lose precious history -- by the very nature of the conversion, <em>every</em> line in the file would be marked as modified.
</p><p>For new files that you create, try to ensure that the line endings in your file are uniform -- either all LF, or all CR-LF.
</p><p>Please verify before commiting that your changes won't lose history, you can do this by examining the output of:
</p>
<pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">git diff</span>
$ <span style="color: #c20cb9; font-weight: bold;">git diff</span> <span style="color: #660033;">--stat</span></pre>
<p>If you feel Git's automatic line-ending normalizer is kicking in inappropriately and changing too many lines, you can add a corresponding entry for that file in a nearby <code>.gitattributes</code> file, preferably in the same directory
</p>
<pre class="bash" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">/</span>FileWithCRLF.cs <span style="color: #660033;">-crlf</span></pre>
<p>If you're facing this issue a lot, you might want consider turning off the GIT configuration variable 'core.autocrlf' for mono repositories.
</p><p>Caveat: We are trying to come up with better Git annotations so that all newly created code files have LF line endings.  Git itself seems to be in a transition from one mechanism to another, and there are several edge cases that seem to trip us up.  So, this is just an interim suggestion.
</p>
<h1> <span class="mw-headline" id="Best_Practices"> Best Practices </span></h1>
<p>Correctness is essential for the Mono class libraries. Because our code is called by many other people, we often must be more pendantic than most people would be when writing code. These items are guidelines of some things you should check for.
</p><p>The class libraries are grouped together in the assemblies they belong.
</p><p>Each directory here represents an assembly, and inside each directory we divide the code based on the namespace they implement.
</p><p>In addition, each assembly directory contains a Test directory that holds the NUnit tests for that assembly.
</p><p>We use a new build system which is described by various README files in mcs/build
</p><p>The build process typically builds an assembly, but in some cases it also builds special versions of the assemblies intended to be used\ for testing.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Documentation"> Documentation </span></h2>
<p>As you write new features, user visible or developer visible consider that the feature will be invisible to users unless it is documented.   If you write new features and there is no accompanying documentation, the feature is for all purposes bloat as only a handful of developers will know about it, but everyone will pay the price by carrying this undocumented code with them.
</p>
<h2> <span class="mw-headline" id="Tests"> Tests </span></h2>
<p>When fixing a bug, write a test, so we can make sure that we do not re-introduce bugs in the future accidentally.
</p><p>When writing new code, write tests to exercise the API.
</p><p>Write tests when you are exploring an API on Windows, you will have to write test cases anyways to understand how the API works.  Instead of writing throw away code, write NUnit tests that will test return values, properties and behavior and then write the new implementation using your tests as a baseline.
</p><p>Code should never be checked into the repository that breaks the build, or breaks any of the existing tests.
</p>
<h2> <span class="mw-headline" id="Check_all_arguments"> Check all arguments </span></h2>
<p>Public functions must check their arguments in exactly the same was as Microsoft's framework. It is important to throw exceptions such as ArgumentNullException rather than NullReferenceException. Adding test to the <a href="{{site.baseurl}}/old_site/Test_Suite" title="Test Suite">Test Suite</a> is important for these.
</p>
<h2> <span class="mw-headline" id="Be_careful_about_freeing_memory"> Be careful about freeing memory </span></h2>
<p>In general, whenever you create a class that is disposeable, you need to use the using {} pattern. This way, resources get disposed. Do <i>not</i> rely on finalizers to get run. This can lead to performance problems.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Watch_for_integer_.5Bunder.7Cover.5Dflows"> Watch for integer [under|over]flows </span></h2>
<p>Integer overflows and underflows are <a href="http://pages.infinit.net/ctech/20050610-0319.html" class="external text" rel="nofollow">possible</a> in managed code. They can lead to ugly problem if your code deals with unsafe code, internal calls or p/invokes. So for every integer parameter you should ask yourself how your code would react to a Int32.MaxValue or a Int32.MinValue (substitute Int32 for your integral type). Unit tests are a nice way to remember that you reviewed your code.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Locking_and_Threading"> Locking and Threading </span></h2>
<p>As humans, we are trained to think about one thing at a time. We, by nature, are not multi-taskers. Thus, when we write code, we tend to think about it as if it was the only thing happening on the operating system. Sadly, this is not the case. In Mono, we are providing a base framework for others to use. This means that our code can often be called from multiple threads. Our code might be running on 8 cpu server with hyperthreading.
</p>
<h3> <span class="mw-headline" id="Deadlocks"> Deadlocks </span></h3>
<p>In managed code, the most common way to deadlock is to have reverse locking order:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">object</span> lockA<span style="color: #008000;">;</span>
<span style="color: #6666cc; font-weight: bold;">object</span> lockB<span style="color: #008000;">;</span>
&#160;
<span style="color: #6666cc; font-weight: bold;">void</span> Foo <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
   <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>lockA<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>lockB<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #008000;">&#125;</span>
   <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #6666cc; font-weight: bold;">void</span> Bar <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
   <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>lockB<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>lockA<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #008000;">&#125;</span>
   <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Imagine that one thread is inside Foo and has just acquired lock A, while another thread is in Bar and just acquired lock B. Now, the Foo thread wants lockB, which is owned by Bar. However, in order for Bar to release it, it must acquire lockA. Nobody can make progress and the program deadlocks. In order to avoid this situation, we <b>must</b> ensure that our locks get acquired in the same order each time.
</p><p>One consequence of this is that we generally can not call code outside of our control under a lock. Imagine this code:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// class library</span>
<span style="color: #6666cc; font-weight: bold;">class</span> Blah <span style="color: #008000;">&#123;</span>
    Hashtable ht<span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">void</span> Foo <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> zzz, Entry blah<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
       <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>ht<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
           ht<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>zzz, blah<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
&#160;
    <span style="color: #6666cc; font-weight: bold;">void</span> Bar <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>ht<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
          <span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span>Entry e <span style="color: #0600FF; font-weight: bold;">in</span> ht<span style="color: #008000;">&#41;</span>
             EachBar <span style="color: #008000;">&#40;</span>e<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
&#160;
    <span style="color: #0600FF; font-weight: bold;">virtual</span> <span style="color: #6666cc; font-weight: bold;">void</span> EachBar <span style="color: #008000;">&#40;</span>Entry e<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #008080; font-style: italic;">// User</span>
<span style="color: #6666cc; font-weight: bold;">class</span> MyBlah <span style="color: #008000;">:</span> Blah <span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">void</span> DoStuff <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
          <span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> GetNumber <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
          Entry e <span style="color: #008000;">=</span> GetEntry <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
          Foo <span style="color: #008000;">&#40;</span>i, e<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
&#160;
    <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">void</span> EachBar <span style="color: #008000;">&#40;</span>Entry e<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
           DoSomething <span style="color: #008000;">&#40;</span>e<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>The same kind of deadlock that happened above happens here because the user acquired another lock inside ours. To avoid this, we must not call user code inside our locks.
</p>
<h3> <span class="mw-headline" id="Don.27t_lock_on_Types_and_Strings"> Don't lock on Types and Strings </span></h3>
<p>Code like lock (typeof (T)) is not good. Type objects can be shared across appdomains, which can lead to unexpected behavior. Also, if the type is public, a user could lock on the type and create deadlocks. Strings are interned, and thus the same type of problems can occur. In general, the best practice is to do:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">object</span> lockobj <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">object</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
<span style="color: #008000;">...</span>
&#160;
<span style="color: #0600FF; font-weight: bold;">lock</span> <span style="color: #008000;">&#40;</span>lockobj<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
<span style="color: #008000;">...</span>
<span style="color: #008000;">&#125;</span></pre>
<h1> <span class="mw-headline" id="Git_Workflow_Changes"> Git Workflow Changes </span></h1>
<h2> <span class="mw-headline" id="One_Line_Summaries"> One Line Summaries </span></h2>
<p>Before your full commit message, use a one-line summary of the change as this improves the output of GitHub's rendering of changes done to the project.
</p><p>After this one line change, you can add the regular, full-documented version of the change.
</p>
<h2> <span class="mw-headline" id="No_more_manual_ChangeLog_editing"> No more manual ChangeLog editing </span></h2>
<p>We no longer maintain ChangeLog files by hand.   You still must create a commit message that contains a 1-line summary and a detailed description of the changes in your commit.
</p><p>Remember, this is used by maintainers over the course of the project.   Mono is almost 10 years old now, so we need this information for future maintainers to look at.
</p><p>The ChangeLogs are automatically generated at distribution time from the Git commit messages.
</p>
<h2> <span class="mw-headline" id="Personal_Work_Branches"> Personal Work Branches </span></h2>
<p>See the description of  <a href="{{site.baseurl}}/old_site/GitFAQ#Workflow_2:_Use_.27master.27_as_integration_branch" title="GitFAQ"> short term branches</a> and
<a href="{{site.baseurl}}/old_site/GitFAQ#Workflow_3:_Long-term_projects" title="GitFAQ"> long term branches</a> in <a href="{{site.baseurl}}/old_site/GitFAQ" title="GitFAQ">GitFAQ</a>.
</p><p>If you publish any feature branches, you should do so on forked repositories,  not on the main mono module.  Branches on repositories under <a href="http://github.com/mono" class="external free" rel="nofollow">http://github.com/mono</a> should be used for release engineering, bugfixes and integration; not for feature development.
</p><p>As somewhat of a corollary, you need to fork only when you publish your feature branch.  After all, Git treats your local clone as a first-class repository, not just as a mirror of some remote repository.  You <em>don't</em> need to fork to create local branches.
</p><p>It is good practice to publish a long-term feature branch early so as to encourage review and collaboration, and to make the integration of your feature go smoothly.
</p><p>When you are satisfied your feature is ready to be included in the next release of the project, you will need to  integrate your feature into the <code>master</code> branch.  Submit a pull request to the appropriate project or sub-module maintainer: this involves going to the webpage of your fork at github.com, using the "Switch Branch" drop-down-list to select the branch to be released, and clicking on the "Pull Request" button.
</p><p>If you do have write access to the main mono repository, you might be asked to commit to it directly.  At this point you should follow the <a href="{{site.baseurl}}/old_site/GitFAQ" title="GitFAQ">GitFAQ</a> suggestions on how to merge branches onto <code>master</code>.
</p>
