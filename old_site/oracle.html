---
layout: obsolete
title: "Oracle"
permalink: /old_site/Oracle/
---

<h1>Oracle</h1>

<p><br />
Mono comes with an Oracle client in the System.Data.OracleClient assembly and tracks the Microsoft System.Data.OracleClient library.    This library has been discontinued by Microsoft and is no longer maintained.
</p><p>Oracle produces a client for Windows, but they do not support this on Mono.   
</p><p>Some commercial providers for Mono are available:
</p>
<ul><li> <a href="http://www.devart.com/dotconnect/oracle/" class="external free" rel="nofollow">http://www.devart.com/dotconnect/oracle/</a>
</li><li> <a href="http://www.datadirect.com/products/net/net%5Ffor%5Foracle/index.ssp" class="external free" rel="nofollow">http://www.datadirect.com/products/net/net%5Ffor%5Foracle/index.ssp</a>
</li></ul>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Info"><span class="tocnumber">1</span> <span class="toctext">Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Current_Status_for_System.Data.OracleClient"><span class="tocnumber">2</span> <span class="toctext">Current Status for System.Data.OracleClient</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Action_plan"><span class="tocnumber">3</span> <span class="toctext">Action plan</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Testing"><span class="tocnumber">4</span> <span class="toctext">Testing</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Building_C.23_Examples"><span class="tocnumber">6</span> <span class="toctext">Building C# Examples</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Info"> Info </span></h2>
<ul><li> ADO.NET Data Provider for <a href="http://www.oracle.com/" class="external text" rel="nofollow">Oracle</a> databases
</li></ul>
<ul><li> Exists in namespace System.Data.OracleClient and assembly System.Data.OracleClient.dll
</li></ul>
<ul><li> Works on Windows, Linux x86, and Solaris x86.  Can you help us get it to work on other systems, such as, Solaris SPARC and Mac OS X?
</li></ul>
<ul><li> Works with Oracle 8i, 9i, 10g, and 11g databases
</li></ul>
<ul><li> Uses OCI (Oracle call-level interface) which is a C library for accessing Oracle databases
</li></ul>
<ul><li> System.Data.OracleClient is deprecated in Microsoft .Net 4.0
</li></ul>
<ul><li> Alternative that works on Mono but is not included with Mono - <a href="http://www.devart.com/dotconnect/oracle/" class="external text" rel="nofollow">dotConnect for Oracle</a>
</li></ul>
<h2> <span class="mw-headline" id="Current_Status_for_System.Data.OracleClient"> Current Status for System.Data.OracleClient </span></h2>
<ul><li> You have two ways to connect to Oracle: using a User ID and Password or using external authentication using "Integrated Security=true" in your connection string  
</li></ul>
<ul><li> OracleCommandBuilder has been implemented and can let you do simple Inserts/Updates/Deletes with a DataSet and OracleDataAdapter.  However, OracleDataReader needs more implementation for getting KeyInfo and other meta data correctly.  The Oracle SQL parser is very simple and will not be able to handle complex queries.  Will need a real Oracle SQL parser which would use the jay compiler-compiler.  Jay is used by mcs to parse c# files and System.Data to parse expressions in a DataColumn.
</li></ul>
<ul><li> REF CURSOR can be returned from a stored procedure as an OracleDataReader via an output parameter defined as OracleType.Cursor
</li></ul>
<ul><li> Connection pooling working
</li></ul>
<ul><li> OracleConnection can connect to Oracle 8i, 9i, and 10g databases via OCI (Oracle Call Level Interface)
</li></ul>
<ul><li> Input and Output parameters (char, varchar2, number, date, raw, long varchar, blob, clob, and timestamp) can now be used in SQL queries, non-queries, PL/SQL Blocks, and stored procedures. 
</li></ul>
<ul><li> Input/Output and Return parameters have not been tested.
</li></ul>
<ul><li> OracleException and Error handling exists.
</li></ul>
<ul><li> Message handling needs to be added for non-critical messages received from Oracle (IN PROGRESS)
</li></ul>
<ul><li> Handling of various data types need to be added [IN PROGRESS]
</li></ul>
<ul><li> Data Adapter exists, and a DataSet can be filled using it.  
</li></ul>
<ul><li> May not work on non-X86 platforms such as Mac OS X nor Solaris SPARC.  Does not work due to byte-ordering or alignment issues with different processors.  We accept patches to get these platforms working.
</li></ul>
<h2> <span class="mw-headline" id="Action_plan"> Action plan </span></h2>
<ul><li> Parameters support needs to be Cleaned up (Input and Output parameters WORKING).  Input/Output and Return parameters are a TODO)
</li></ul>
<ul><li> Support for Oracle 8i on Linux and Windows (WORKING)
</li></ul>
<ul><li> Support for Oracle 9i on Linux and Windows (WORKING.  Still need to add features for 9i).  
</li></ul>
<ul><li> Support for Oracle 10g on Linux and Windows (WORKING.  Still need to add features for 10g)
</li></ul>
<ul><li> Support for Oracle 10g on Mac OS X.  This requires resolving byte-ordering and alignment issues (TODO).
</li></ul>
<ul><li> Support for Oracle 10g on Solaris x86.  (WORKING on Solaris 10 x86 and Solaris Express x86)
</li></ul>
<ul><li> Support for Oracle 10g on Solaris SPARC.  This requires resolving byte-ordering and alignment issues (TODO)
</li></ul>
<ul><li> Support for Oracle 10g Express Edition on Windows and Linux (WORKING)
</li></ul>
<ul><li> Support for Oracle 11g on Linux and Windows (WORKING)
</li></ul>
<ul><li> Support Large Objects like LONG VARCHAR, BLOB, CLOB (WORKING)
</li></ul>
<ul><li> Support all the data types (STILL IMPLEMENTING).  Still need to implement INTERVAL.  Many of the Oracle .net types like OracleDateTime internally use a System .net type like DateTime.  This is insufficient for supporting Oracle data types like TIMESTAMP.
</li></ul>
<ul><li> Security Audit (TODO)
</li></ul>
<ul><li> NLS / Unicode support / Multi-byte character sets (NEEDS IMPROVEMENT)
</li></ul>
<h2> <span class="mw-headline" id="Testing"> Testing </span></h2>
<p><b>Prerequisites</b> 
</p>
<ul><li> Have a working mono and gmcs. 
</li></ul>
<ul><li> Have access to an Oracle 8i, 9i, 10g, 10g Express, or 11g database or download it from <a href="http://www.oracle.com/technology/software/index.html" class="external text" rel="nofollow">Oracle Downloads</a>. If you are connecting remotely to an Oracle database, you need the Oracle client software. Registration to the <a href="http://www.oracle.com/technology/index.html" class="external text" rel="nofollow">Oracle Technology Network</a> is free. If installing on Linux, I suggest you do a lot of searching to see how others installed Oracle on Linux. <a href="http://www.puschitz.com/OracleOnLinux.shtml" class="external text" rel="nofollow">Werner Puschitz's Oracle on Linux page</a> contains great step by step guides on installing Oracle on Linux.
</li></ul>
<ul><li> <a href="http://www.oracle.com/technology/software/products/database/xe/index.html" class="external text" rel="nofollow">Oracle Database 10g Express Edition</a> is free to download and redistribute.  It works on Windows and Linux.  It is also much easier to install the Express edition compared to the Enterprise and Standard editions.
</li></ul>
<ul><li> If you do not have any Oracle software installed on the computer you are running Mono but you need to access an Oracle database remotely, may I suggest using the <a href="http://www.oracle.com/technology/tech/oci/instantclient/index.html" class="external text" rel="nofollow">Oracle Instant Client</a>.  The Oracle Instant Client is far more easier to install than the normal Oracle client software.  You can also re-distribute the Oracle Instant Client for free.
</li></ul>
<ul><li> Oracle 10g Express Edition (XE) installation on Debian/Ubuntu Linux is a breeze via apt-get.  
</li></ul>
<pre>
 Basically, you add to your /etc/apt/sources.list

    deb http://oss.oracle.com/debian unstable main non-free 
  
 And then run the following:

    sudo apt-get update
    sudo apt-get install oracle-xe-universal
    sudo /etc/init.d/oracle-xe configure 
</pre>
<ul><li> In the mcs source code, you can find tests at mcs/class/System.Data.OracleClient/Test
</li></ul>
<ul><li> The Data Source is an Oracle TNS Name
</li></ul>
<p><b>Connection String Format</b> 
</p>
<ul><li> Has a connection string format:
</li></ul>
<pre>
 &quot;Data Source=tnsname;User ID=userid;Password=password&quot; </pre>
<p><b>Connection String Format using TNS network description which does not use a tnsnames.ora file</b> 
</p>
<ul><li> Has a connection string format:
</li></ul>
<pre>
 &quot;User ID=SCOTT;&quot; +
 &quot;Password=TIGER;&quot; +
 &quot;Data Source=(&quot; +
 &quot;DESCRIPTION=(&quot; +
 &quot;ADDRESS=(PROTOCOL=TCP)(HOST=192.168.1.101)(PORT=1521))&quot; +
 &quot;(CONNECT_DATA=(SERVER=DEDICATED)&quot; +
 &quot;(SERVICE_NAME=TESTDB)))&quot; </pre>
<p><b>Connection String Format for External Authentication</b> 
</p>
<ul><li> Has a connection string format:
</li></ul>
<pre>
 &quot;Data Source=tnsname;Integrated Security=true&quot; </pre>
<ul><li> Connection String Parameters:
</li></ul>
<table border="1" cellpadding="2" cellspacing="0" align="center" style="margin: 0 0 1em 1em; text-align:left; border-collapse:collapse; border:1px gray solid; font-size:95%; background:#f9f9f9">
<tr>
<th> Parameter Definition </th>
<th> Description </th>
<th> Example
</th></tr>
<tr>
<td> Server or Data Source </td>
<td> TNS Name or Network Address of the Oracle instance to connect </td>
<td> Server=TESTDB
</td></tr>
<tr>
<td> User ID </td>
<td> name of Oracle database user </td>
<td> User ID=scott
</td></tr>
<tr>
<td> Password  </td>
<td> password for Oracle database user </td>
<td> Password=mypass12
</td></tr>
<tr>
<td> Integrated Security </td>
<td> To connect using external authentication or not.  Valid values for Integrated Security are: YES or TRUE to use external authentication.  NO or FALSE to not use external authentication.  The default is false. </td>
<td> Integrated Security=true
</td></tr>
<tr>
<td> Min Pool Size </td>
<td> Specifies the minimum number of connections in the connection pool.  Default is 0. </td>
<td> Min Pool Size=0
</td></tr>
<tr>
<td> Max Pool Size </td>
<td> Specifies the maximum number of connections in the connection pool.  Default is 100. </td>
<td> Max Pool Size=100
</td></tr>
<tr>
<td> Pooling </td>
<td> Specifies whether or not to use connection pooling.  Valid values are TRUE or YES to use connection pooling or FALSE or NOT to not use connection pooling.  Default is TRUE. </td>
<td> Pooling=true
</td></tr></table>
<ul><li> If you use External Authentication, make sure you have a user created externally.  Also, make sure you know what you are doing if you use external authentication - there are security implications.  Read <a href="http://download-east.oracle.com/docs/cd/B19306_01/network.102/b14268/asoauth.htm#sthref731" class="external text" rel="nofollow">OracleÂ® Database Advanced Security Administrator's Guide</a> for more info about external authentication.
</li></ul>
<ul><li> How-To create a Windows user named SomeUser on Windows NT/2000 Domain MyNTDomain for external authentication in Oracle:  If you're not on a Windows domain, then your MachineName is the Domain.  Note how the domain user is in double quotes and is upper case.
</li></ul>
<p>CREATE USER "MYNTDOMAIN\SOMEUSER" IDENTIFIED EXTERNALLY;
</p>
<ul><li> How-To create a Linux user named someuser in Oracle which gets authenticated externally:
</li></ul>
<p>CREATE USER someuser IDENTIFIED EXTERNALLY;
</p>
<h2> <span class="mw-headline" id="Examples"> Examples </span></h2>
<b>C# Example 1a - Basic Connection and Retrieval</b> <pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.OracleClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Data Source=testdb;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=scott;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=tiger;&quot;</span><span style="color: #008000;">;</span>
       OracleConnection dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleConnection <span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       OracleCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;SELECT ename, job FROM scott.emp&quot;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       OracleDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
          <span style="color: #6666cc; font-weight: bold;">string</span> employeeName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;ename&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
          <span style="color: #6666cc; font-weight: bold;">string</span> job <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;job&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
          Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Employee Name: {0}  Job: {1}&quot;</span>,
		                    employeeName, job<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
       <span style="color: #008080; font-style: italic;">// clean up</span>
       reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<b>C# Example 1b - Basic Connection and Retrieval using Integrated Security</b> <pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.OracleClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Data Source=testdb;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Integrated Security=true&quot;</span><span style="color: #008000;">;</span>
       OracleConnection dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleConnection <span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       OracleCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;SELECT ename, job FROM scott.emp&quot;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       OracleDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
          <span style="color: #6666cc; font-weight: bold;">string</span> employeeName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;ename&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
          <span style="color: #6666cc; font-weight: bold;">string</span> job <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;job&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
          Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Employee Name: {0}  Job: {1}&quot;</span>,
		                    employeeName, job<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
       <span style="color: #008080; font-style: italic;">// clean up</span>
       reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<b>C# Example 2 - Calling Stored Procedure</b> <pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.OracleClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Data Source=testdb;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=scott;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=tiger;&quot;</span><span style="color: #008000;">;</span>
       OracleConnection dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleConnection <span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Drop table MONO_TEST_TABLE2...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       OracleCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       <span style="color: #0600FF; font-weight: bold;">try</span> <span style="color: #008000;">&#123;</span>
              dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;DROP TABLE MONO_TEST_TABLE2&quot;</span><span style="color: #008000;">;</span>
              dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
       <span style="color: #0600FF; font-weight: bold;">catch</span><span style="color: #008000;">&#40;</span>OracleException oe1<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
              <span style="color: #008080; font-style: italic;">// ignore if table already exists</span>
       <span style="color: #008000;">&#125;</span>
&#160;
       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Drop procedure SP_TEST2...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">try</span> <span style="color: #008000;">&#123;</span>
              dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;DROP PROCEDURE SP_TEST2&quot;</span><span style="color: #008000;">;</span>
              dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
       <span style="color: #0600FF; font-weight: bold;">catch</span><span style="color: #008000;">&#40;</span>OracleException oe1<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
              <span style="color: #008080; font-style: italic;">// ignore if table already exists</span>
       <span style="color: #008000;">&#125;</span>
&#160;
       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Create table MONO_TEST_TABLE2...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;CREATE TABLE MONO_TEST_TABLE2 (&quot;</span> <span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot; COL1 VARCHAR2(8), &quot;</span><span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot; COL2 VARCHAR2(32))&quot;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Create stored procedure SP_TEST2...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
              <span style="color: #666666;">&quot;CREATE PROCEDURE SP_TEST2(parm1 VARCHAR2,parm2 VARCHAR2) &quot;</span> <span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot; IS &quot;</span> <span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot; BEGIN &quot;</span> <span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot;	    INSERT INTO MONO_TEST_TABLE2 (COL1,COL2) VALUES (parm1,parm2);&quot;</span> <span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot;	    COMMIT;&quot;</span> <span style="color: #008000;">+</span>
              <span style="color: #666666;">&quot; END;&quot;</span><span style="color: #008000;">;</span>
&#160;
              cmd2<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  COMMIT...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;COMMIT&quot;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Call stored procedure SP_TEST2 with two parameters...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       OracleCommand dbcmd <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandType</span> <span style="color: #008000;">=</span> CommandType<span style="color: #008000;">.</span><span style="color: #0000FF;">StoredProcedure</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;sp_test2&quot;</span><span style="color: #008000;">;</span>
&#160;
       OracleParameter myParameter1 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleParameter<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;parm1&quot;</span>, OracleType<span style="color: #008000;">.</span><span style="color: #0000FF;">VarChar</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       myParameter1<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;myval&quot;</span><span style="color: #008000;">;</span>
       myParameter1<span style="color: #008000;">.</span><span style="color: #0000FF;">Size</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">8</span><span style="color: #008000;">;</span>
       myParameter1<span style="color: #008000;">.</span><span style="color: #0000FF;">Direction</span> <span style="color: #008000;">=</span> ParameterDirection<span style="color: #008000;">.</span><span style="color: #0000FF;">Input</span><span style="color: #008000;">;</span>
&#160;
       OracleParameter myParameter2 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleParameter<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;parm2&quot;</span>, OracleType<span style="color: #008000;">.</span><span style="color: #0000FF;">VarChar</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       myParameter2<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;another&quot;</span><span style="color: #008000;">;</span>
       myParameter2<span style="color: #008000;">.</span><span style="color: #0000FF;">Size</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">32</span><span style="color: #008000;">;</span>
       myParameter2<span style="color: #008000;">.</span><span style="color: #0000FF;">Direction</span> <span style="color: #008000;">=</span> ParameterDirection<span style="color: #008000;">.</span><span style="color: #0000FF;">Input</span><span style="color: #008000;">;</span>
&#160;
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Parameters</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>myParameter1<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Parameters</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>myParameter2<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<p><b>C# Example 3 - Executing PL/SQL Block</b>
</p><p>Why would I want to do that?  Let's say I need to execute a stored procedure, yet there is no support for Boolean data type in OCI.  I can do this via a PL/SQL block.
</p><p><br />
</p>
<pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.OracleClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Data Source=testdb;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=scott;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=tiger;&quot;</span><span style="color: #008000;">;</span>
       OracleConnection con <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       con <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleConnection <span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       con<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		OracleCommand cmd <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Drop procedure SP_TESTPLSQLBLOCK1...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">try</span> 
		<span style="color: #008000;">&#123;</span>
			cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;DROP PROCEDURE SP_TESTPLSQLBLOCK1&quot;</span><span style="color: #008000;">;</span>
			cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
		<span style="color: #0600FF; font-weight: bold;">catch</span><span style="color: #008000;">&#40;</span>OracleException oe1<span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			<span style="color: #008080; font-style: italic;">// ignore if table already exists</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Create stored procedure SP_TESTPLSQLBLOCK1...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008080; font-style: italic;">// stored procedure add two number depending on a boolean</span>
&#160;
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
			<span style="color: #666666;">&quot;CREATE OR REPLACE PROCEDURE SP_TESTPLSQLBLOCK1(PARM1 IN NUMBER,PARM2 IN BOOLEAN,PARM3 OUT NUMBER)<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;IS<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;BEGIN<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;   IF PARM2 = TRUE THEN<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;	   PARM3&#160;:= PARM1 + 7;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;	ELSE<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;	   PARM3&#160;:= PARM1 + 13;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;   END IF;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;END;&quot;</span><span style="color: #008000;">;</span>
&#160;
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  COMMIT...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;COMMIT&quot;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;  Call stored procedure SP_TESTPLSQLBLOCK1 with 3 parameters...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandType</span> <span style="color: #008000;">=</span> CommandType<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
			<span style="color: #666666;">&quot;DECLARE &quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;   addnum BOOLEAN&#160;:= sys.diutil.int_to_bool(:P2); &quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;BEGIN &quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;	SP_TESTPLSQLBLOCK1(:P1,addnum,:P3); &quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;END;&quot;</span><span style="color: #008000;">;</span>
		OracleParameter myParameter1 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleParameter<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;P1&quot;</span>, OracleType<span style="color: #008000;">.</span><span style="color: #0000FF;">Number</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		myParameter1<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">5</span><span style="color: #008000;">;</span>
		myParameter1<span style="color: #008000;">.</span><span style="color: #0000FF;">Direction</span> <span style="color: #008000;">=</span> ParameterDirection<span style="color: #008000;">.</span><span style="color: #0000FF;">Input</span><span style="color: #008000;">;</span>
&#160;
		OracleParameter myParameter2 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleParameter<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;P2&quot;</span>, OracleType<span style="color: #008000;">.</span><span style="color: #0000FF;">Number</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		myParameter2<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">;</span>
		myParameter2<span style="color: #008000;">.</span><span style="color: #0000FF;">Direction</span> <span style="color: #008000;">=</span> ParameterDirection<span style="color: #008000;">.</span><span style="color: #0000FF;">Input</span><span style="color: #008000;">;</span>
&#160;
		OracleParameter myParameter3 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleParameter<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;P3&quot;</span>, OracleType<span style="color: #008000;">.</span><span style="color: #0000FF;">Number</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		myParameter3<span style="color: #008000;">.</span><span style="color: #0000FF;">Direction</span> <span style="color: #008000;">=</span> ParameterDirection<span style="color: #008000;">.</span><span style="color: #0000FF;">Output</span><span style="color: #008000;">;</span>
&#160;
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Parameters</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>myParameter1<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Parameters</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>myParameter2<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Parameters</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>myParameter3<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #6666cc; font-weight: bold;">decimal</span> d <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">decimal</span><span style="color: #008000;">&#41;</span> myParameter3<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span><span style="color: #008000;">;</span>
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;    Out Value should be: 12&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;    Out Value: {0}&quot;</span>, d<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		con<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		con <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<p><b>C# Example 4 - ASP.NET DataGrid Data Binding to an Oracle database table</b>
</p>
<pre>First, you will need to make sure there is a table named CUSTOMERS with some data.
</pre>
<pre class="csharp" style="font-family:monospace;"> CREATE TABLE CUSTOMERS <span style="color: #008000;">&#40;</span>
	person varchar2<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">256</span><span style="color: #008000;">&#41;</span> NOT <span style="color: #0600FF; font-weight: bold;">NULL</span>,
	email varchar2<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">256</span><span style="color: #008000;">&#41;</span> NOT <span style="color: #0600FF; font-weight: bold;">NULL</span>
 <span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
 INSERT <span style="color: #0600FF; font-weight: bold;">INTO</span> CUSTOMERS
 <span style="color: #008000;">&#40;</span>PERSON, EMAIL<span style="color: #008000;">&#41;</span>
 VALUES<span style="color: #008000;">&#40;</span><span style="color: #666666;">'Bob Jones'</span>,<span style="color: #666666;">'bjones@nowhere.edu'</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
 INSERT <span style="color: #0600FF; font-weight: bold;">INTO</span> CUSTOMERS
 <span style="color: #008000;">&#40;</span>PERSON, EMAIL<span style="color: #008000;">&#41;</span>
 VALUES<span style="color: #008000;">&#40;</span><span style="color: #666666;">'John Smith'</span>,<span style="color: #666666;">'jswmith@somewhere.com'</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
 COMMIT<span style="color: #008000;">;</span></pre>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008000;">&lt;%</span>@ Page Language<span style="color: #008000;">=</span><span style="color: #666666;">&quot;C#&quot;</span> <span style="color: #008000;">%&gt;</span>
<span style="color: #008000;">&lt;%</span>@ import <span style="color: #0600FF; font-weight: bold;">namespace</span><span style="color: #008000;">=</span><span style="color: #666666;">&quot;System.Data&quot;</span> <span style="color: #008000;">%&gt;</span>
<span style="color: #008000;">&lt;%</span>@ import <span style="color: #0600FF; font-weight: bold;">namespace</span><span style="color: #008000;">=</span><span style="color: #666666;">&quot;System.Data.Common&quot;</span> <span style="color: #008000;">%&gt;</span>
<span style="color: #008000;">&lt;%</span>@ import <span style="color: #0600FF; font-weight: bold;">namespace</span><span style="color: #008000;">=</span><span style="color: #666666;">&quot;System.Data.SqlTypes&quot;</span> <span style="color: #008000;">%&gt;</span>
<span style="color: #008000;">&lt;%</span>@ import <span style="color: #0600FF; font-weight: bold;">namespace</span><span style="color: #008000;">=</span><span style="color: #666666;">&quot;System.Data.OracleClient&quot;</span> <span style="color: #008000;">%&gt;</span>
<span style="color: #008000;">&lt;%</span>@ import <span style="color: #0600FF; font-weight: bold;">namespace</span><span style="color: #008000;">=</span><span style="color: #666666;">&quot;System.Reflection&quot;</span> <span style="color: #008000;">%&gt;</span>
<span style="color: #008000;">&lt;%</span>@ assembly Name<span style="color: #008000;">=</span><span style="color: #666666;">&quot;System.Data.OracleClient&quot;</span> <span style="color: #008000;">%&gt;</span>
&#160;
<span style="color: #008000;">&lt;</span>html<span style="color: #008000;">&gt;</span>
<span style="color: #008000;">&lt;</span>head<span style="color: #008000;">&gt;</span>
<span style="color: #008000;">&lt;</span>title<span style="color: #008000;">&gt;</span>ASP<span style="color: #008000;">.</span><span style="color: #0000FF;">NET</span> DataGrid Data Binding to an Oracle database table<span style="color: #008000;">&lt;/</span>title<span style="color: #008000;">&gt;</span>
&#160;
<span style="color: #008000;">&lt;!--</span> Source code modified <span style="color: #0600FF; font-weight: bold;">from</span> samples <span style="color: #0600FF; font-weight: bold;">in</span> xsp was originally made <span style="color: #0600FF; font-weight: bold;">by</span> Gonzalo Paniagua Javier <span style="color: #008000;">--&gt;</span>
&#160;
<span style="color: #008000;">&lt;</span>script runat<span style="color: #008000;">=</span><span style="color: #666666;">&quot;server&quot;</span><span style="color: #008000;">&gt;</span>
&#160;
	<span style="color: #0600FF; font-weight: bold;">static</span> Type cncType <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #6666cc; font-weight: bold;">void</span> GetConnectionData <span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">out</span> <span style="color: #6666cc; font-weight: bold;">string</span> providerAssembly, 
                               <span style="color: #0600FF; font-weight: bold;">out</span> <span style="color: #6666cc; font-weight: bold;">string</span> cncTypeName, <span style="color: #0600FF; font-weight: bold;">out</span> <span style="color: #6666cc; font-weight: bold;">string</span> cncString<span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		providerAssembly <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		cncTypeName <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		cncString <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		NameValueCollection config <span style="color: #008000;">=</span> 
                       ConfigurationSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">AppSettings</span> <span style="color: #0600FF; font-weight: bold;">as</span> NameValueCollection<span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>config <span style="color: #008000;">!=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> s <span style="color: #0600FF; font-weight: bold;">in</span> config<span style="color: #008000;">.</span><span style="color: #0000FF;">Keys</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
				<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span> <span style="color: #008000;">==</span> <span style="color: #6666cc; font-weight: bold;">String</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Compare</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;DBProviderAssembly&quot;</span>, s, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
					providerAssembly <span style="color: #008000;">=</span> config <span style="color: #008000;">&#91;</span>s<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
				<span style="color: #008000;">&#125;</span> <span style="color: #0600FF; font-weight: bold;">else</span> <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span> <span style="color: #008000;">==</span> <span style="color: #6666cc; font-weight: bold;">String</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Compare</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;DBConnectionType&quot;</span>, s, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
					cncTypeName <span style="color: #008000;">=</span> config <span style="color: #008000;">&#91;</span>s<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
				<span style="color: #008000;">&#125;</span> <span style="color: #0600FF; font-weight: bold;">else</span> <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span> <span style="color: #008000;">==</span> <span style="color: #6666cc; font-weight: bold;">String</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Compare</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;DBConnectionString&quot;</span>, s, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
					cncString <span style="color: #008000;">=</span> config <span style="color: #008000;">&#91;</span>s<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
				<span style="color: #008000;">&#125;</span>
			<span style="color: #008000;">&#125;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>providerAssembly <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span> <span style="color: #008000;">||</span> providerAssembly <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;&quot;</span><span style="color: #008000;">&#41;</span>
			providerAssembly <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;System.Data.OracleClient&quot;</span><span style="color: #008000;">;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>cncTypeName <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span> <span style="color: #008000;">||</span> cncTypeName <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;&quot;</span><span style="color: #008000;">&#41;</span>
			cncTypeName <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;System.Data.OracleClient.OracleConnection&quot;</span><span style="color: #008000;">;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>cncString <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span> <span style="color: #008000;">||</span> cncString <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;&quot;</span><span style="color: #008000;">&#41;</span>
			cncString <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Data Source=TESTDB;User ID=scott;Password=tiger&quot;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
&#160;
	IDbConnection cnc<span style="color: #008000;">;</span>
	<span style="color: #6666cc; font-weight: bold;">void</span> Page_Load <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, EventArgs e<span style="color: #008000;">&#41;</span> 
	<span style="color: #008000;">&#123;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> connectionTypeName<span style="color: #008000;">;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> providerAssemblyName<span style="color: #008000;">;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> cncString<span style="color: #008000;">;</span>
&#160;
		GetConnectionData <span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">out</span> providerAssemblyName, 
                       <span style="color: #0600FF; font-weight: bold;">out</span> connectionTypeName, <span style="color: #0600FF; font-weight: bold;">out</span> cncString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>cncType <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>		
			Assembly dbAssembly <span style="color: #008000;">=</span> Assembly<span style="color: #008000;">.</span><span style="color: #0000FF;">LoadWithPartialName</span> <span style="color: #008000;">&#40;</span>
                                                      providerAssemblyName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			cncType <span style="color: #008000;">=</span> dbAssembly<span style="color: #008000;">.</span><span style="color: #0000FF;">GetType</span> <span style="color: #008000;">&#40;</span>connectionTypeName, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">!</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span style="color: #008000;">typeof</span></a> <span style="color: #008000;">&#40;</span>IDbConnection<span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">IsAssignableFrom</span> <span style="color: #008000;">&#40;</span>cncType<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
				<span style="color: #0600FF; font-weight: bold;">throw</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> ApplicationException <span style="color: #008000;">&#40;</span>
                                        <span style="color: #666666;">&quot;The type '&quot;</span> <span style="color: #008000;">+</span> cncType <span style="color: #008000;">+</span>
					<span style="color: #666666;">&quot;' does not implement IDbConnection.<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
					<span style="color: #666666;">&quot;Check 'DbConnectionType' in web.config&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		cnc <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>IDbConnection<span style="color: #008000;">&#41;</span> Activator<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateInstance</span> <span style="color: #008000;">&#40;</span>cncType<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cnc<span style="color: #008000;">.</span><span style="color: #0000FF;">ConnectionString</span> <span style="color: #008000;">=</span> cncString<span style="color: #008000;">;</span>
&#160;
		cnc<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		OracleCommand cmd <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>OracleCommand<span style="color: #008000;">&#41;</span> cnc<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;select * from CUSTOMERS&quot;</span><span style="color: #008000;">;</span>
		DbDataAdapter adapter <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleDataAdapter<span style="color: #008000;">&#40;</span>cmd<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		DataTable table <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> DataTable<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;CUSTOMERS&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Fill</span><span style="color: #008000;">&#40;</span>table<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		grid<span style="color: #008000;">.</span><span style="color: #0000FF;">DataSource</span> <span style="color: #008000;">=</span> table<span style="color: #008000;">;</span>
		grid<span style="color: #008000;">.</span><span style="color: #0000FF;">DataBind</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		cmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		cnc<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
&#160;
	<span style="color: #6666cc; font-weight: bold;">void</span> Page_PreRender <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, EventArgs e<span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>cnc <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span>
			<span style="color: #0600FF; font-weight: bold;">return</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
&#160;
 <span style="color: #008000;">&lt;/</span>script<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;/</span>head<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;</span>body<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;</span>h3<span style="color: #008000;">&gt;</span>DataGrid sample<span style="color: #008000;">&lt;/</span>h3<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;</span>form runat<span style="color: #008000;">=</span><span style="color: #666666;">&quot;server&quot;</span><span style="color: #008000;">&gt;</span>
 	<span style="color: #008000;">&lt;</span>asp<span style="color: #008000;">:</span>datagrid id<span style="color: #008000;">=</span><span style="color: #666666;">&quot;grid&quot;</span> border<span style="color: #008000;">=</span><span style="color: #666666;">&quot;1&quot;</span> 
		EnableViewState<span style="color: #008000;">=</span><span style="color: #666666;">&quot;false&quot;</span> runat<span style="color: #008000;">=</span><span style="color: #666666;">&quot;server&quot;</span><span style="color: #008000;">&gt;</span>
	<span style="color: #008000;">&lt;/</span>asp<span style="color: #008000;">:</span>datagrid<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;/</span>form<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;/</span>body<span style="color: #008000;">&gt;</span>
 <span style="color: #008000;">&lt;/</span>html<span style="color: #008000;">&gt;</span></pre>
<p><br />
<b>C# Example 5 - Returning a REF CURSOR from an Oracle stored procedure via an OracleDataReader from an out parameter</b>
</p>
<pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.OracleClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Data Source=testdb;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=scott;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=tiger;&quot;</span><span style="color: #008000;">;</span>
        OracleConnection connection <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
        connection <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleConnection <span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        connection<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Setup test package and data...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	OracleCommand cmddrop <span style="color: #008000;">=</span> connection<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	cmddrop<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;DROP TABLE TESTTABLE&quot;</span><span style="color: #008000;">;</span>
	<span style="color: #0600FF; font-weight: bold;">try</span> <span style="color: #008000;">&#123;</span> 
		cmddrop<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span> 
	<span style="color: #008000;">&#125;</span> 
	<span style="color: #0600FF; font-weight: bold;">catch</span><span style="color: #008000;">&#40;</span>OracleException e<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Ignore this error: &quot;</span> <span style="color: #008000;">+</span> e<span style="color: #008000;">.</span><span style="color: #0000FF;">Message</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span> 
	<span style="color: #008000;">&#125;</span>
	cmddrop<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	cmddrop <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
	OracleCommand cmd <span style="color: #008000;">=</span> connection<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #008080; font-style: italic;">// create table TESTTABLE</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
		<span style="color: #666666;">&quot;create table TESTTABLE (<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot; col1 numeric(18,0),<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot; col2 varchar(32),<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot; col3 date)&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #008080; font-style: italic;">// insert some rows into TESTTABLE</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
		<span style="color: #666666;">&quot;insert into TESTTABLE<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;(col1, col2, col3)<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;values(45, 'Mono', sysdate)&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
		<span style="color: #666666;">&quot;insert into TESTTABLE<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;(col1, col2, col3)<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;values(136, 'Fun', sysdate)&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
		<span style="color: #666666;">&quot;insert into TESTTABLE<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;(col1, col2, col3)<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;values(526, 'System.Data.OracleClient', sysdate)&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;commit&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #008080; font-style: italic;">// create Oracle package TestTablePkg</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
		<span style="color: #666666;">&quot;CREATE OR REPLACE PACKAGE TestTablePkg<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;AS<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;	TYPE T_CURSOR IS REF CURSOR;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;	PROCEDURE GetData(tableCursor OUT T_CURSOR);<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;END TestTablePkg;&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #008080; font-style: italic;">// create Oracle package body for package TestTablePkg</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
		<span style="color: #666666;">&quot;CREATE OR REPLACE PACKAGE BODY TestTablePkg AS<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;  PROCEDURE GetData(tableCursor OUT T_CURSOR)<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>	
                <span style="color: #666666;">&quot;  IS<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;  BEGIN<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;    OPEN tableCursor FOR<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;    SELECT *<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;    FROM TestTable;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;  END GetData;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span> <span style="color: #008000;">+</span>
		<span style="color: #666666;">&quot;END TestTablePkg;&quot;</span><span style="color: #008000;">;</span>
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	cmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Set up command and parameters to call stored proc...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	OracleCommand command <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleCommand<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;TestTablePkg.GetData&quot;</span>, connection<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	command<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandType</span> <span style="color: #008000;">=</span> CommandType<span style="color: #008000;">.</span><span style="color: #0000FF;">StoredProcedure</span><span style="color: #008000;">;</span>
	OracleParameter parameter <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OracleParameter<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;tableCursor&quot;</span>, OracleType<span style="color: #008000;">.</span><span style="color: #0000FF;">Cursor</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	parameter<span style="color: #008000;">.</span><span style="color: #0000FF;">Direction</span> <span style="color: #008000;">=</span> ParameterDirection<span style="color: #008000;">.</span><span style="color: #0000FF;">Output</span><span style="color: #008000;">;</span>
	command<span style="color: #008000;">.</span><span style="color: #0000FF;">Parameters</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span>parameter<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Execute...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	command<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Get OracleDataReader for cursor output parameter...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	OracleDataReader reader <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>OracleDataReader<span style="color: #008000;">&#41;</span> parameter<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span><span style="color: #008000;">;</span>
&#160;
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Read data...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #6666cc; font-weight: bold;">int</span> r <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
	<span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
		Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Row {0}&quot;</span>, r<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> f <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> f <span style="color: #008000;">&lt;</span> reader<span style="color: #008000;">.</span><span style="color: #0000FF;">FieldCount</span><span style="color: #008000;">;</span> f <span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #6666cc; font-weight: bold;">object</span> val <span style="color: #008000;">=</span> reader<span style="color: #008000;">.</span><span style="color: #0000FF;">GetValue</span><span style="color: #008000;">&#40;</span>f<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;    Field {0} Value: {1}&quot;</span>, f, val<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
		r <span style="color: #008000;">++;</span>
	<span style="color: #008000;">&#125;</span>
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Rows retrieved: {0}&quot;</span>, r<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Clean up...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
	command<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	command <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
        connection<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        connection <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<p><br />
</p>
<h2> <span class="mw-headline" id="Building_C.23_Examples"> Building C# Examples </span></h2>
<p>Save the example to a file, such as, TestExample.cs
</p>
<ul><li> Build with Mono C# compiler:
</li></ul>
<pre>
 mcs TestExample.cs /r:System.Data.dll /r:System.Data.OracleClient.dll
</pre>
<ul><li> Running the Example:
</li></ul>
<pre>
 mono TestExample.exe 
</pre>

